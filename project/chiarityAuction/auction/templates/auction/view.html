{% extends "base.html" %}{% load static %}{% load crispy_forms_tags %}{% block head_title %}{{ block.super }} - View{% endblock head_title %}{% block content %}<body class="body" style="background-color: darkolivegreen"><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous"><body id="list" style="background-color: whitesmoke">    <div class="container" style="">        <div class="row">            <div class="col">                <h2 style="color:#12232E ; font-family: 'Apple Braille'">Listing Details</h2>            </div>            {% if listing.profile != request.user %}            <div class="col">                <form action="{% url 'watchlist' %}" method="post">                    {% csrf_token %}                    {% if not  watchlisted %}                        <input type="hidden" name="listing_id" value="{{listing.id}}">                        <button type="submit" style="background-color:coral; color:#12232E; margin-left:120px">add to watchlist</button>                    {% else %}                        <button disabled="disable">add to watchlist</button>                    {% endif %}                </form>            </div>            {% endif %}        </div>    </div>    <div id="code" style="max-width:6vw; max-height:6vh;background-color:burlywood;border-radius:20px 20px 20px 20px;border-style:solid;    margin-left:300px; margin-bottom:10px;"><p style="margin:10px;">CODE {{listing.auction_number}}</p></div>    {% if messages %}        {% for message in messages %}            <div class="alert {{message.tags}}">                {{message}}            </div>        {% endfor %}    {% endif %}    {% if request.user == listing.current_winner and listing.active == False %}            <h3>You won this auction!</h3>    {% endif %}    <br><br>    <div class="row row-cols-1 row-cols-md-3 g-4" style="background-color: burlywood;border-style: solid ;height:40vh;" >  <div class="col">    <div class="card">      <div class="card-body">        <h5 class="card-title">Type Product</h5>        <p class="card-text">{{listing.product}}</p>      </div>    </div>  </div>  <div class="col">    <div class="card">      <div class="card-body">        <h5 class="card-title">Description</h5>        <p class="card-text">{{listing.description}}</p>      </div>    </div>  </div>  <div class="col">    <div class="card">      <div class="card-body">        <h5 class="card-title"> Object Donated by</h5>        <p class="card-text"> {{listing.profile.user}}</p>      </div>    </div>  </div>  <div class="col">    <div class="card">      <div class="card-body">        <h5 class="card-title" style="color: lightseagreen"><mark>Current Winner</mark></h5>          {% if listing.current_winner %}        <p class="card-text">{{listing.current_winner}}</p>            {% else %}        <p class="card-text">No bids yet</p>            {% endif %}      </div>    </div>  </div>        <div class="col">    <div class="card">      <div class="card-body">        <h5 class="card-title">Status</h5>            {% if listing.active %}        <p class="card-text"style="color: darkred"><strong>Active</strong></p>            {% else %}        <p class="card-text"style="color: black">Inactive</p>            {% endif %}      </div>    </div>  </div><div class="col" style="display:inline-block">    <div class="card">      <div class="card-body">        <h5 class="card-title">Start &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;             &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;            End</h5>        <p class="card-text"> {{listing.start}} &nbsp;</p>            <p class="color" style=" color:darkred; font-size:1.5rem; margin-left: 120px">  {{listing.end}}</p>      </div>    </div>  </div>    <br><br>    {% if listing.photo %}    <div class="card" style="max-width:23vw;background-color: wheat ;height:50vh;    ;box-shadow:5px 5px 100px 20px darkred; border-radius: 10px 10px 10px 10px ; border-color:#203647;display: flex; flex-wrap: nowrap; align-content:flex-end; ">        <img class="card-img-top" src="{{listing.photo.url}}" alt="Card image" style="max-width:50%;padding: 2rem">             <div class="card-body">             <h4 class="card-title" style="font-family: 'Apple Braille',sans-serif"> Product: {{listing.product}}</h4>            <p class="card-text"style="font-family: 'Apple Braille',sans-serif; font-size: 2rem">  Starting_Bid:     {{listing.starting_bid}}$</p>            <p class="card-text" style="color: darkred;font-family: 'Apple Braille',sans-serif; font-size: 2rem">  <U>Current Price</U>: {{listing.current_price}} $</p>            </div>    </div>    {% endif %} </div>    <br> <br>  <br>    <div class="container"style="border-color:black; display:flex; margin-left:600px">        <div id="clockdiv">            <div>                <span class="days"></span>                <div class="smalltext">Days</div><div id="cd_day"></div>            </div>            <div>                <span class="hours"></span>                <div class="smalltext">Hours</div><div id="cd_hh"></div>            </div>            <div>                <span class="minutes"></span>                <div class="smalltext">Minutes</div><div id="cd_mm"></div>            </div>            <div>                <span class="seconds"></span>                <div class="smalltext">Seconds</div>  <div id="cd_ss"></div>            </div>        </div>    </div>    <script>        let started = false;        djangoend = new Date("{{ listing.end.isoformat }}");        function timerCustom() {            let x = setInterval(() => {                var now = new Date().getTime();                var distance = djangoend - now;                if (distance < 0) {                    clearInterval(x);                    document.getElementById("cd_expire").innerHTML = "AUCTION CONCLUDED";                    fetch('/batch');                    if (started)                        location.reload();                    return                }                started = true;                var days = Math.floor(distance / (1000 * 60 * 60 * 24));                var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));                var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));                var seconds = Math.floor((distance % (1000 * 60)) / 1000);                document.getElementById("cd_day").innerHTML = days;                document.getElementById("cd_hh").innerHTML = hours;                document.getElementById("cd_mm").innerHTML = minutes;                document.getElementById("cd_ss").innerHTML = seconds;            }, 1000)        }        {% if listing.active %}            timerCustom()        {% endif %}    </script>    {% if request.user.pk == listing.profile_id and listing.active == True %}    <br><br><br><div class="position" style="margin-left: 900px ;">    <div class="card text-dark bg-warning mb-3" style="max-width: 18rem;border-color: black ">  <div class="card-header"style="  color:#12232E;font-family: Apple Braille, sans-serif;" >Do you want to edit your listing?</div>        <a class="btn btn-secondary" style="color:white; background-color: burlywood;border-radius:10px 10px 10px 10px;         border-color: black;width:70%;height:40px;margin-left: 30px; margin-top:20px;" href="{% url 'edit_listing' listing.id %}">            <h6 style="font-family: 'Apple Braille',sans-serif;margin-top:8px; ">Edit</h6>        </a>  <div class="card-body">  </div></div><div class="card text-white bg-danger mb-3" style="max-width: 18rem;border-color: black;height:185px">  <div class="card-header" style="font-family: 'Apple Braille',sans-serif;font-size: medium">Closed Auction Early (irreversible action)</div>  <div class="card-body">          <form action="{% url 'close_auction' listing.id %}" method="post">            {% csrf_token %}            <div id="closed">            <button type="button" class="btn btn-dark" data-bs-toggle="modal" id="launch-button" data-bs-target="#closeAuctionModal"                    style="background-color: burlywood; border-radius: 10px 10px 10px 10px ;width:180px;height:50px;margin-left:8px;padding:10px;">                Closed Auction Early </button>            </div>            <div class="modal fade" id="closeAuctionModal" tabindex="-1" role="dialog" aria-labelledby="closeAuctionModalLabel" aria-hidden="true">                <div class="modal-dialog" role="document">                <div class="modal-content">                    <div class="modal-header"><!--                    <h5 class="modal-title" id="closeAuctionModalLabel">Are you sure to close this auction?</h5>--><!--                    <button type="button" class="close" data-dismiss="modals" aria-label="Close">--><!--                        <span aria-hidden="true">&times</span>--><!--                    </button>-->                    </div>                         <div class="modal-body">                                 <p class="text" style="color:black"> Winner: {{listing.current_winner}}</p> <br>                                <p class="text" style="color:black">Price: {{listing.current_price}}</p>                         </div>                    <div class="modal-footer">                    <button type="submit"  value="Finish this auction" class="btn btn-danger">CLOSED</button>                    </div>                </div>                </div>            </div>        </form>      </div>  </div></div>    {% else %}        {% if request.user.is_authenticated and listing.active == True %}    <br><br><br>            <form action="{% url 'set_bid' listing.id %}" method="post">                {% csrf_token %}                <h2 style="color: #12232E; margin-left:600px;margin-bottom: 10px; font-family: 'Apple Braille, sans-serif'">Make your offer !! </h2>                    <input type="number" min="{{listing.current_price}}" step="any" name="bid"                           placeholder="{{listing.current_price}}"style="height:80px;width: 150px;border-style:solid ;                           margin-left:600px">                    <button class="btn btn-secondary" type="submit" style="background-color:darkred;                    color:white;height: 60px;width:100px;border-radius: 20px 20px;margin-left:50px">                      BID                    </button>            </form>        {% endif %}    {% endif %}<br><br><div class="container" style="padding-top: 10rem" >    <div class="row">        <div class="col">            <h4 style="font-family: 'Apple Braille',sans-serif; margin-left: 15px">more information about this product?</h4>        </div>        {% if request.user.is_authenticated %}        <form action="{% url 'comment' listing.id %}" method="post"> {% csrf_token %}            <div class="modal-body">                <input type="text" name="comment" placeholder="Write Here......" style="border-color: burlywood; margin-bottom: 10px;"/>                <input type="submit" value="More Info" style="border-color: black; background-color:  darkseagreen;                color: white; width:7vw;height:5vh; margin-left:500px; border-radius:15px 15px 15px 15px"/>            </div>        </form>        <div class="modal fade" id="commentModal" tabindex="-1" role="dialog" aria-labelledby="commentModal" aria-hidden="true">            <div class="modal-dialog" role="document">            <div class="modal-content">                <div class="modal-header">                <h5 class="modal-title" id="commentLabel">New Comment:</h5>                <button type="button" class="close" data-dismiss="modal" aria-label="Close">                    <span aria-hidden="true">&times;</span>                </button>                </div>                <form action="{% url 'comment' listing.id %}" method="post"> {% csrf_token %}                    <div class="modal-body">                    <textarea class="form-control" name="comment" cols="30" rows="10">                                            </textarea>                     </div>                    <div class="modal-footer">                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>                    <button class="btn btn-primary" type="submit">Post comment</button>                    </div>                </form>            </div>            </div>        </div>        {% endif %}    </div>    <table class="table" style="border-style: solid;">        <thead>            <th>user</th>            <th>comment</th>            <th>date</th>        </thead>        {% for comment in comments  %}        <tr>            <td>                {{comment.author.user}}            </td>            <td>                {{comment.text}}            </td>            <td>                {{comment.date}}            </td>        </tr>        {% endfor %}    </table>  </div><body>  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>   {% endblock content %}